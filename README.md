# 🛍️ Telegram Digital Store Bot

بوت تليجرام احترافي لمتجر المنتجات الرقمية مع Mini App حديث ونظام نقاط متكامل.

## ✨ المميزات

### 🎯 المميزات الرئيسية
- 🛒 **متجر رقمي متكامل** - بيع المنتجات الرقمية بسهولة
- 💎 **نظام النقاط** - نظام نقاط بديل للدفع الحقيقي
- 📱 **Mini App احترافي** - تطبيق ويب حديث باستخدام Telegram SDK الرسمي
- 🎨 **Telegram CSS3** - استخدام Telegram CSS Variables الرسمية فقط
- ⚙️ **لوحة إدارة مدمجة** - داخل Mini App نفسه (بدون باسوورد)
- 🔐 **تحقق آمن** - التحقق من المستخدم عبر User ID مباشرة
- 🚀 **بسيط وسريع** - كل شيء يعمل من Mini App

### 💰 طرق كسب النقاط
1. **مشاهدة الإعلانات** - إعلانات فيديو وروابط
2. **دعوة الأصدقاء** - نظام إحالة ذكي
3. **مكافآت يومية** - قابلة للتخصيص

### 🔌 تكامل APIs
- **CPAGrip** - للإعلانات والمحتوى
- **Shorte.st** - لاختصار الروابط مع إعلانات

### ⚙️ لوحة الإدارة
- 📊 إحصائيات شاملة
- 🛍️ إدارة المنتجات والمحتوى
- 📢 إدارة الإعلانات
- 👥 إدارة المستخدمين
- 💎 تعديل النقاط (إضافة/خصم)
- ⚙️ إعدادات متقدمة

## 📋 المتطلبات

- PHP 7.4 أو أحدث
- SQLite3
- cURL enabled
- Telegram Bot Token
- استضافة ويب مع HTTPS

## 🚀 التثبيت

### 1. رفع الملفات

قم برفع جميع ملفات المشروع إلى استضافتك في المسار:
```
https://bot1.be-eb.net/store/
```

### 2. إعداد الصلاحيات

تأكد من أن المجلدات التالية لديها صلاحيات الكتابة (755 أو 777):
```bash
chmod 755 database/
chmod 755 uploads/
chmod 755 uploads/products/
```

### 3. تعديل الإعدادات

افتح ملف `config.php` وتأكد من صحة البيانات:

```php
// Bot Configuration
define('BOT_TOKEN', '8330185902:AAFMHcrEgPPAaiYYnz-cwpntBdTCY6qsqao');
define('BOT_USERNAME', 'STBEBOT');
define('ADMIN_ID', 7732118455);
define('BASE_URL', 'https://bot1.be-eb.net/store/');
```

### 4. إعداد Webhook

افتح المتصفح وانتقل إلى:
```
https://bot1.be-eb.net/store/setWebhook.php
```

يجب أن ترى رسالة نجاح: `✅ Webhook set successfully!`

### 5. إعداد Mini App في BotFather

1. افتح [@BotFather](https://t.me/BotFather) في تليجرام
2. أرسل `/mybots` واختر البوت
3. اختر "Bot Settings" > "Menu Button"
4. اختر "Configure Menu Button"
5. أدخل URL التطبيق:
   ```
   https://bot1.be-eb.net/store/app/index.html
   ```
6. أدخل نص الزر: `🛍 المتجر`

### 6. اختبار البوت

افتح البوت في تليجرام:
```
https://t.me/STBEBOT
```

أرسل `/start` - يجب أن يرد البوت برسالة الترحيب!

## 📁 هيكل المشروع

```
bot-store/
├── config.php              # إعدادات البوت
├── webhook.php             # معالج Webhook
├── setWebhook.php         # إعداد Webhook
├── database/
│   ├── Database.php       # فئة قاعدة البيانات
│   └── store.db          # قاعدة بيانات SQLite
├── bot/
│   └── Bot.php           # منطق البوت
├── api/
│   ├── api.php           # API endpoints للـ Mini App
│   └── ads.php           # تكامل APIs الإعلانات
├── app/                  # Mini App
│   └── index.html        # صفحة التطبيق
├── assets/
│   ├── css/
│   │   └── style.css     # تصميم التطبيق
│   └── js/
│       └── app.js        # منطق التطبيق
├── admin/
│   └── index.php         # لوحة الإدارة
└── uploads/
    └── products/         # صور المنتجات
```

## 🎮 استخدام البوت

### للمستخدمين

#### الأوامر الأساسية:
- `/start` - بدء البوت والحصول على القائمة الرئيسية
- `/help` - عرض المساعدة
- `/mypoints` - عرض النقاط والإحصائيات
- `/store` - فتح المتجر
- `/earn` - طرق كسب النقاط
- `/referral` - رابط الدعوة

#### استخدام المتجر:
1. افتح البوت واضغط على زر "المتجر" أو أرسل `/store`
2. سيفتح Mini App مع المنتجات المتاحة
3. اختر المنتج الذي تريده
4. اضغط على "شراء" وأكد الشراء
5. سيتم تسليم المنتج فوراً في البوت!

#### كسب النقاط:
1. **مشاهدة الإعلانات**: اضغط على "اكسب نقاط" واختر إعلان
2. **دعوة الأصدقاء**: اضغط على "دعوة الأصدقاء" وشارك رابطك
3. ستحصل على نقاط فوراً عند انضمام صديقك!

### للمدراء

#### الوصول إلى لوحة الإدارة:

افتح المتصفح وانتقل إلى:
```
https://bot1.be-eb.net/store/admin/
```

**كلمة المرور الافتراضية**: `admin123`

⚠️ **مهم**: قم بتغيير كلمة المرور في ملف `admin/index.php`

#### إدارة المنتجات:

1. **إضافة منتج جديد**:
   - اذهب إلى تبويب "المنتجات"
   - املأ النموذج (الاسم، الوصف، السعر، الكمية)
   - اضغط "إضافة المنتج"

2. **إضافة محتوى للمنتج**:
   - اختر المنتج من القائمة
   - أدخل المحتوى (كل سطر = محتوى واحد)
   - مثال:
     ```
     CODE-ABC-123
     CODE-XYZ-456
     CODE-DEF-789
     ```
   - اضغط "إضافة المحتوى"

#### إدارة الإعلانات:

1. اذهب إلى تبويب "الإعلانات"
2. املأ البيانات:
   - النوع: فيديو أو رابط
   - العنوان
   - رابط الإعلان
   - النقاط المكتسبة
3. اضغط "إضافة الإعلان"

#### إدارة المستخدمين:

1. **إضافة/خصم نقاط**:
   - أدخل User ID (معرف المستخدم)
   - أدخل كمية النقاط
   - اختر العملية (إضافة/خصم)
   - اضغط "تحديث النقاط"

2. **لمعرفة User ID**: يمكن رؤيته في تبويب "المستخدمين"

#### الإعدادات:

في تبويب "الإعدادات" يمكنك تعديل:

- **إعدادات النقاط**:
  - نقاط الإعلان (فيديو)
  - نقاط الإعلان (رابط)
  - نقاط الدعوة

- **APIs**:
  - CPAGrip API Key
  - Shorte.st API Key

- **الرسائل**:
  - رسالة الترحيب

## 🔐 الأمان

### حماية لوحة الإدارة:

1. **تغيير كلمة المرور**:

   افتح `admin/index.php` وعدّل السطر:
   ```php
   $admin_password = 'admin123'; // غيّر هذا!
   ```

2. **إضافة حماية .htaccess** (اختياري):

   أنشئ ملف `.htaccess` في مجلد `admin/`:
   ```apache
   AuthType Basic
   AuthName "Admin Area"
   AuthUserFile /path/to/.htpasswd
   Require valid-user
   ```

### حماية قاعدة البيانات:

تأكد من عدم إمكانية الوصول لملف قاعدة البيانات من المتصفح:

أضف إلى `.htaccess` في المجلد الرئيسي:
```apache
<Files "*.db">
    Order allow,deny
    Deny from all
</Files>
```

## 🔧 تكوين APIs

### CPAGrip:

1. سجّل في [CPAGrip](https://www.cpagrip.com/)
2. احصل على API Key من لوحة التحكم
3. أدخلها في لوحة الإدارة > الإعدادات

### Shorte.st:

1. سجّل في [Shorte.st](https://shorte.st/)
2. احصل على API Token
3. أدخله في لوحة الإدارة > الإعدادات

## 📊 قاعدة البيانات

البوت يستخدم SQLite مع الجداول التالية:

- **users** - بيانات المستخدمين
- **products** - المنتجات
- **product_content** - محتوى المنتجات (أكواد، روابط)
- **orders** - الطلبات
- **ads** - الإعلانات
- **ad_views** - مشاهدات الإعلانات
- **referrals** - الدعوات
- **transactions** - حركات النقاط
- **settings** - الإعدادات
- **notifications** - الإشعارات

## 🐛 استكشاف الأخطاء

### البوت لا يرد:

1. تحقق من Webhook:
   ```
   https://bot1.be-eb.net/store/setWebhook.php
   ```

2. تحقق من ملف الأخطاء:
   ```
   error.log
   ```

3. تحقق من صلاحيات المجلدات

### Mini App لا يعمل:

1. تحقق من رابط Mini App في BotFather
2. افتح الرابط في المتصفح للتأكد من عمله
3. تحقق من Console في المتصفح (F12)

### مشاكل في قاعدة البيانات:

1. تحقق من صلاحيات مجلد `database/`
2. احذف `database/store.db` وسيتم إنشاؤه تلقائياً

## 🎨 التخصيص

### تغيير الألوان:

عدّل ملف `assets/css/style.css`:

```css
:root {
    --primary-color: #3390ec;
    --success-color: #34c759;
    --warning-color: #ff9500;
    --danger-color: #ff3b30;
}
```

### تغيير النصوص:

عدّل ملف `bot/Bot.php` للنصوص داخل البوت
عدّل ملف `app/index.html` للنصوص في Mini App

## 📝 الأوامر الإدارية في البوت

للمدير فقط (Admin ID):

- `/admin` - لوحة الإدارة السريعة
- `/stats` - عرض الإحصائيات
- `/broadcast رسالتك` - إرسال رسالة جماعية

## 🔄 التحديثات

للحصول على آخر التحديثات:

1. احتفظ بنسخة احتياطية من قاعدة البيانات
2. ارفع الملفات الجديدة
3. تحقق من التوافق

## 📧 الدعم

للمساعدة والدعم:

- Telegram: [@support](https://t.me/support)
- Issues: افتح Issue في GitHub

## 📄 الترخيص

هذا المشروع مرخص تحت MIT License.

## 🙏 شكر خاص

- [Telegram Bot API](https://core.telegram.org/bots/api)
- [Telegram Mini Apps](https://core.telegram.org/bots/webapps)
- مجتمع المطورين العرب

---

**صُنع بـ ❤️ في السعودية**

## 🚨 ملاحظات مهمة

1. **قم بتغيير كلمة مرور لوحة الإدارة فوراً!**
2. **لا تشارك API Keys مع أحد**
3. **احتفظ بنسخة احتياطية من قاعدة البيانات بانتظام**
4. **تأكد من أن HTTPS مفعّل على استضافتك**
5. **راجع ملف error.log بانتظام**

## 📱 معلومات البوت

- **Bot Username**: [@STBEBOT](https://t.me/STBEBOT)
- **Bot Token**: `8330185902:AAFMHcrEgPPAaiYYnz-cwpntBdTCY6qsqao`
- **Admin ID**: `7732118455`
- **Base URL**: `https://bot1.be-eb.net/store/`

---

**استمتع ببوتك الجديد! 🎉**